{% extends "layout.html" %}
{% block title %}My messages | {{config.LEMA}}{% endblock %}
{% block navbar %}

{% endblock %}

{% block sidebar %}
{{ super() }}
<div class="row buttons inbox">
  <div class="col-4"><a class="btn{% if current_user.new_pm_count() > 0 %} btn-orange{% endif %}" href="{{ url_for('view_messages') }}">inbox{% if current_user.new_pm_count() > 0 %} <i class="fa fa-envelope" aria-hidden="true"></i> {{current_user.new_pm_count()}}{% endif %}</a></div>
  <div class="col-4"><a class="btn{% if current_user.new_reply_count() > 0 %} btn-orange{% endif %}" href="{{ url_for('view_messages_replies') }}">replies{% if current_user.new_reply_count() > 0 %} <i class="fa fa-envelope" aria-hidden="true"></i> {{current_user.new_reply_count()}}{% endif %}</a></div>
  <div class="col-4"><a class="btn"  href="{{ url_for('view_messages_sent') }}">sent</a></div>
</div>
{% endblock %}

{% block content %}
{{ super() }}
<div class="user-activity col-12">
    <h3>{{messages|length}} {{box_name}}</h3>
{% for message in messages %}
  {% if message.mtype == 0 %}
    <article class="post">
      <div class="main">
        <p class="title">You have been invited to help moderate /s/{{message.subject}}</p>
        <p class="container"></p>
          Please visit the <a href="{{url_for('edit_sub_mods', sub=message.subject)}}">mod page</a>.
        </p>
        <p class="author"><time-ago datetime="{{message.posted.isoformat()}}"></time-ago></p>
        <p class="container">
          <a href="{#url_for('view_user', user=message.getMsgSentBy)#}" class="btn small"><i class="fa fa-user" aria-hidden="true"></i>/u/{#message.getMsgSentBy#}</a>
          {% if not message.read %}
          <a class="unread btn btn-orange edit small" data-mid="{{message.mid}}"><i class="fa fa-circle-o" aria-hidden="true"></i> mark as read</a>
          {% else %}
          <a class="read btn small"><i class="fa fa-folder-open" aria-hidden="true"></i> read</a>
          {% endif %}
          <a class="delete btn small btn-red" data-mid="{{message.mid}}"><i class="fa fa-trash" aria-hidden="true"></i> delete</a>
        </p>
      </div>
    </article>
  {% else %}
    <article class="post">
      <div class="main">
        {% if box_name == 'Replies' %}
        <p class="title"><a href="{{url_for('view_post_inbox', pid=message.mtype)}}">{{message.subject}}</a></p>
        {% else %}
        <p class="title">{{message.subject}}</p>
        {% endif %}
        <p class="container">{{message.content}}</p>
        <p class="author"><time-ago datetime="{{message.posted.isoformat()}}"></time-ago></p>
        <p class="container">
          {% if box_name != 'Sent' %}
          <a href="{{url_for('view_user', user=message.getMsgSentBy)}}" class="btn small"><i class="fa fa-user" aria-hidden="true"></i>/u/{{message.getMsgSentBy}}</a>
          {% if not message.read %}
          <a class="unread btn btn-orange edit small" data-mid="{{message.mid}}"><i class="fa fa-circle-o" aria-hidden="true"></i> mark as read</a>
          {% else %}
          <a class="read btn small"><i class="fa fa-folder-open" aria-hidden="true"></i> read</a>
          {% endif %}
          <a class="btn small"><i class="fa fa-mail-reply" aria-hidden="true"></i> reply</a>
          <a class="btn small"><i class="fa fa-mail-forward" aria-hidden="true"></i> forward</a>
          <a class="delete btn small btn-red" data-mid="{{message.mid}}"><i class="fa fa-trash" aria-hidden="true"></i> delete</a>
          {% else %}
          <a href="{{url_for('view_user', user=message.getMsgRecBy)}}" class="btn small"><i class="fa fa-user" aria-hidden="true"></i>/u/{{message.getMsgRecBy}}</a>
          {% endif %}
        </p>
      </div>
    </article>
  {% endif %}
{% endfor %}
</div>
{% endblock %}
{%block pagefoot%}

{%endblock%}
