{% extends "layout.html" %}
{% block title %}{{config.LEMA}}{% endblock %}

{% block navbar %}
{{ super() }}
<li><a href="{{url_for('admin_area')}}">Admin</a></li>
{% endblock %}
{% block sidebar %}
{{ super() }}
<hr>
{% include 'adminsidebar.html' %}
{% endblock %}

{% block content %}
{{ super() }}
<div class="admin section stats">
  <table class="col-12">
    <tr>
      <td class="col-2"><i class="fa fa-user" title="users"></i></td>
      <td class="col-2"><i class="fa fa-users" title="subs"></i></td>
      <td class="col-2"><i class="fa fa-list" title="posts"></i></td>
      <td class="col-2"><i class="fa fa-comments" title="comments"></i></td>
      <td class="col-2">votes</td>
    </tr>
    <tr>
      <td class="col-2">{{users}}</td>
      <td class="col-2">{{subs}}</td>
      <td class="col-2">{{posts}}</td>
      <td class="col-2">{{comms}}</td>
      <td class="col-2">+{{ups}} | -{{downs}}</td>
    </tr>
  </table>
</div>
<div class="admin section">
    <div class="col-12 admin-page-form">
      <h3>Announcements</h3>
      {% set ann = func.getAnnouncement() %}
      {%if not ann %}<h4>No active announcements</h4>
      {%else%}
      <div class="post">
        <a href="{{url_for('do.deleteannouncement')}}" class="btn btn-red">Nuke!</a> |
        <a href="{{url_for('view_post_inbox', pid=ann.pid)}}">{{ann.title}}</a> by {{db.get_user_from_uid(ann.uid).name}}, <relative-time datetime="{{ann.posted.isoformat()}}Z"></relative-time>
      </div>

      {%endif%}
  </div>
</div>
<div class="admin section badges">
  <div class="col-12"><h2><i class="fa fa-beer"></i> User Badges</h2>
    {% for badge in badges %}
    <div class="col-3">{{loop.index}} - <i title="{{badge.text}}" class="fa {{badge.badge}}"></i> {{badge.name}}</div>
    {% endfor %}
  </div>
  <div class="col-12 admin-page-form">
    <div>
      <form id="create-user-badge" class="nice-form">
        {{createuserbadgeform.csrf_token}}
        <h4>Create new user badge (<a href="http://fontawesome.io/cheatsheet/">cheatsheet</a>)</h4>
        <div class="col-3">{{createuserbadgeform.badge(placeholder=createuserbadgeform.badge.label.text, required=True)}}</div>
        <div class="col-2">{{createuserbadgeform.name(placeholder=createuserbadgeform.name.label.text)}}</div>
        <div class="col-3">{{createuserbadgeform.text(placeholder=createuserbadgeform.text.label.text)}}</div>
        <div class="col-2">{{createuserbadgeform.value(placeholder=createuserbadgeform.value.label.text, value=100)}}</div>
        <div class="col-2"><button type="submit" class="btn btn-blue" id="create-user-badge-btnsubmit">Create badge</button></div>
        <div class="alert div-error">
          <span class="closebtn" onclick="this.parentElement.style.display='none';">&times;</span>
          <p></p>
        </div>
      </form>
    </div>
  </div>
</div>
<div class="admin section BTCaddress">
  <div class="col-12"><h2><i class="fa fa-btc"></i> Bitcoin Donation: {% if func.enableBTCmod() %}Enabled{% else %}Disabled{% endif %}</h2>
  </div>
  <div class="col-12 admin-page-form">
    <div>
      <form id="usebtcdonation" class="nice-form">
        {{usebtcdonationform.csrf_token}}
        <h4>Bitcoin donation address and message</h4>
        <div class="col-12"><label>{{usebtcdonationform.enablebtcmod(checked=func.enableBTCmod())}} {{usebtcdonationform.enablebtcmod.label.text}}</label></div>
        <div class="col-12">{{usebtcdonationform.message(placeholder=usebtcdonationform.message.label.text)}}</div>
        <div class="col-12">{{usebtcdonationform.btcaddress(placeholder=usebtcdonationform.btcaddress.label.text)}}</div>
        <div class="col-3"><button type="submit" class="btn btn-blue" id="usebtcdonation-btnsubmit">Save</button></div>
        <div class="alert div-error">
          <span class="closebtn" onclick="this.parentElement.style.display='none';">&times;</span>
          <p></p>
        </div>
      </form>
    </div>
  </div>
</div>
<div class="admin section invitecode">
  <div class="col-12"><h2><i class="fa fa-key"></i> Invite Code to register: {% if func.enableInviteCode() %}Enabled ({{func.getInviteCode()}}){% else %}Disabled{% endif %}</h2>
  </div>
  <div class="col-12 admin-page-form">
    <div>
      <form id="useinvitecode" class="nice-form" method="POST" action="{{url_for('do.use_invite_code')}}" data-redir="true" class="ajaxform">
        {{useinvitecodeform.csrf_token}}
        <div class="col-12"><label>{{useinvitecodeform.enableinvitecode(checked=func.enableInviteCode())}} {{useinvitecodeform.enableinvitecode.label.text}}</label></div>
        <div class="col-12">{{useinvitecodeform.invitecode(placeholder=useinvitecodeform.invitecode.label.text)}}</div>
        <div class="col-3"><button type="submit" class="btn btn-blue" id="useinvitecodeform-btnsubmit">Save</button></div>
        <div class="alert div-error">
          <span class="closebtn" onclick="this.parentElement.style.display='none';">&times;</span>
          <p></p>
        </div>
      </form>
    </div>
  </div>
</div>
{% endblock %}
