{% extends "layout.html" %}
{% block title %}{{config.LEMA}}{% endblock %}
{% block navbar %}
<ul class="right">
  <li class="large"><a href="{{url_for('sub.view_sub', sub=sub.name)}}">{{conf['SUB_PREFIX']}}/{{sub.name}}</a></li>
</ul>
{% endblock %}
{% block content %}
{{ super() }}

{% if not current_user.is_mod(sub.sid) and current_user.is_admin() %}
<div class="important"><h3>Editing as Admin</h3></div>
{% endif %}

<h1>Moderators for {{conf['SUB_PREFIX']}}/{{sub.name}}</h1>
{% if current_user.is_modinv(sub)  %}
<div class="mod2-inv" >
  You currently have an invite for this sub pending.
  <a id="accept-mod2-inv" data-sub="{{sub.name}}" data-user="{{current_user.user.name}}" class="slink">Accept</a> /
  <a id="refuse-mod2-inv" data-sub="{{sub.name}}" data-user="{{current_user.user.name}}" class="slink">No thanks</a>
</div>
<div class="col-12"><hr></div>
{% endif %}

<div class="col-12">
  <p>Owner: <i class="fa fa-star" title="Owner"></i> <a href="{{url_for('view_user', user=subdata.owner.name)}}">{{subdata.owner.name}}</a></p>
</div>
<div class="col-12"><hr></div>
<div class="col-12">
  <p>Active moderators: {% if subdata.mods|length < 1 %}none{% endif %}</p>
  <ul>
  {% for mod in subdata.mods if subdata.mods|length > 0 %}
  <span class="editmodbtn col-4">
    <li><a href="{{url_for('view_user', user=db.get_user_from_uid(mod.value).name)}}">{{mod.name}}</a>
      {% if current_user.is_admin() or current_user.is_topmod(sub) %}
      (<a data-sub="{{sub.name}}" data-user="{{db.get_user_from_uid(mod.value).name}}" class="slink revoke-mod2">remove</a>)
      {% endif %}
    </li>
  </span>
  {% endfor %}
  </ul>
</div>
<div class="col-12"><hr></div>
<div class="col-12">
  <p>Pending invites: {% if modinvs|length < 1 %}none{% endif %}</p>
  <ul>
  {% for modinv in modinvs if modinvs|length > 0 %}
  <span class="editmodbtn col-4">
    <li><a href="{{url_for('view_user', user=db.get_user_from_uid(modinv.value).name)}}">{{db.get_user_from_uid(modinv.value).name}}</a>
      {% if current_user.is_admin() or current_user.is_topmod(sub) %}
      (<a data-sub="{{sub.name}}" data-user="{{db.get_user_from_uid(modinv.value).name}}" class="slink revoke-mod2inv">revoke</a>)
      {% endif %}
    </li>
    </span>
    {% endfor %}
  </ul>

  {% if current_user.is_admin() or current_user.is_topmod(sub) %}
  <div class="editmoderators col-12">
    <form data-reload="true" action="{{url_for('do.inv_mod2', sub=sub.name)}}" id="edit-mod2-form" data-sub="{{sub.name}}" class="pure-form ajaxform">
      {{editmod2form.csrf_token}}
      <p>
        <label>Invite new mod: {{editmod2form.user(placeholder=editmod2form.user.label.text, required=True)}}</label>
        <button type="submit" class="pure-button pure-button-primary" id="editmod2-btnsubmit">Invite mod</button>
      </p>
      <div class="alert div-error">
        <span class="closebtn" onclick="this.parentElement.style.display='none';">&times;</span>
        <p></p>
      </div>
    </form>
  </div>
  {% endif %}
</div>
<div class="col-12"><hr></div>
<div class="col-12">
  <p>Past mods: {% if xmods|length < 1 %}none{% endif %}</p>
  <ul>
  {% for xmod in xmods if xmods|length > 0 %}
  <span class="col-4">
    <li><i class="fa fa-remove"></i> <a href="{{url_for('view_user', user=db.get_user_from_uid(xmod.value).name)}}">{{db.get_user_from_uid(xmod.value).name}}</a></li>
  </span>
  {% endfor %}
  </ul>
</div>
{% endblock %}
