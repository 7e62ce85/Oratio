{% extends "layout.html" %}
{% block title %}Throat: Open discussion{% endblock %}
{% block navbar %}
<ul class="right">
  <li class="large"><a href="{{url_for('view_sub', sub=sub.name)}}">/s/{{sub.name}}</a></li>
</ul>
{% endblock %}
{% block content %}
{{ super() }}

{% if not current_user.is_mod(sub) and current_user.is_admin() %}
<center><h3>Editing as Admin</h3></center>
{% endif %}

<h1>Moderators for /s/{{sub.name}}</h1>
{% if current_user.is_modinv(sub)  %}
<div class="col-12 mod2-inv">
  <p>You currently have an invite for this sub pending.</p>
  <span id="accept-mod2-inv" data-sub="{{sub.name}}" data-user="{{current_user.user.name}}" class="btn">Accept</span>
  <span class="col-2"></span>
  <span id="refuse-mod2-inv" data-sub="{{sub.name}}" data-user="{{current_user.user.name}}" class="btn">No thanks</span>
</div>
<div class="col-12"><hr></div>
{% endif %}

<div class="col-12">
  <p>Owner: <i class="fa fa-star" title="Owner"></i> <a href="{{url_for('view_user', user=sub.getTopModName)}}">{{sub.getTopModName}}</a></p>
</div>
<div class="col-12"><hr></div>
<div class="col-12">
  <p>Active moderators: {% if mods|length < 1 %}none{% endif %}</p>
  <ul>
  {% for mod in mods if mods|length > 0 %}
  <span class="editmodbtn col-4">
    <li><i class="fa fa-user"></i> <a href="{{url_for('view_user', user=mod.getUsername)}}">{{mod.getUsername}}</a>
      {% if current_user.is_admin() or current_user.is_topmod(sub) %}
      <span id="remove-mod2" data-sub="{{sub.name}}" data-user="{{mod.getUsername}}" class="btn active">remove</span>
      {% endif %}
    </li>
  </span>
  {% endfor %}
  </ul>
</div>
<div class="col-12"><hr></div>
<div class="col-12">
  <p>Pending invites: {% if modinvs|length < 1 %}none{% endif %}</p>
  <ul>
  {% for modinv in modinvs if modinvs|length > 0 %}
  <span class="editmodbtn col-4">
    <li><i class="fa fa-user"></i> <a href="{{url_for('view_user', user=modinv.getUsername)}}">{{modinv.getUsername}}</a>
      {% if current_user.is_admin() or current_user.is_topmod(sub) %}
      <span id="revoke-mod2-inv" data-sub="{{sub.name}}" data-user="{{modinv.getUsername}}" class="btn revoke">cancel</span>
      {% endif %}
    </li>
    </span>
    {% endfor %}
  </ul>

  {% if current_user.is_admin() or current_user.is_topmod(sub) %}
  <div class="editmoderators col-12">
    <form id="edit-mod2-form" data-sub="{{sub.name}}" class="">
      {{editmod2form.csrf_token}}
      <p>
        <label>Invite new mod: {{editmod2form.user(placeholder=editmod2form.user.label.text, required=True)}}</label>
        <button type="submit" class="btn btn-orange" id="editmod2-btnsubmit">Invite mod</button>
      </p>
      <div class="alert div-error">
        <span class="closebtn" onclick="this.parentElement.style.display='none';">&times;</span>
        <p></p>
      </div>
    </form>
  </div>
  {% endif %}
</div>
<div class="col-12"><hr></div>
<div class="col-12">
  <p>Past mods: {% if xmods|length < 1 %}none{% endif %}</p>
  <ul>
  {% for xmod in xmods if xmods|length > 0 %}
  <span class="col-4">
    <li><i class="fa fa-remove"></i> <a href="{{url_for('view_user', user=xmod.getUsername)}}">{{xmod.getUsername}}</a></li>
  </span>
  {% endfor %}
  </ul>
</div>
{% endblock %}
