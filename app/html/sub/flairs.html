@extends("shared/layout.html")
@require(sub, flairs, createflair)

@import 'shared/sidebar/sub_mod.html' as sb
@def sidebar():
  @{sb.render_sidebar('flairs', sub=sub.name)!!html}
@end

@def main():
  @#
  @if not current_user.is_mod(sub.sid, 1) and current_user.is_admin():
    <div class="important"><h3>@{_('Editing as Admin')}</h3></div>
  @end
  <div id="center-container">
    <div class="content mw-75">
      <h1>@{_('Editing flairs of <a href="%(url)s">%(sub)s</a>', url=url_for('sub.view_sub', sub=sub.name), sub=config.site.sub_prefix + "/" + sub.name)!!html}</h1>
      <div class="col-12 admin-page-form">
        <form  method="POST" class="ajaxform pure-form" action="@{url_for('do.create_flair', sub=sub.name)}" data-reload="true">
          <h4>@{_('Create new flair')}</h4>
          @{createflair.csrf_token()!!html}
          @{createflair.text(placeholder=_("Flair text"))!!html}
          <button type="submit" class="pure-button pure-button-primary" id="editsub-btnsubmit" data-prog="@{_('Saving...')}" data-success="@{_('Saved!')}">@{_('Add flair')}</button>
          <div class="alert div-error"></div>
        </form>
      </div>

      @if flairs:
      <hr>
      <h4>@{_('Flairs')}</h4>
      <div class="col-12 admin-page-form">
        <table>
          <thead>
            <tr><th>Flair Name</th><th>Display Order</th><th>Control Panel</th></tr>
          </thead>
          <tbody>
          @for flair in flairs:
            <tr>
              <td>
                <span class="postflair">@{flair.text.data}</span>
              </td>
              <td>@{flair.display_order.data}</td>
              <td>
                <form  method="POST" data-reload="true" action="@{url_for('do.flair_order_up', sub=sub.name, fl=flair.flair.data)}" class="ajaxform st-flair">
                  @{flair.csrf_token()!!html}
                  @{flair.flair!!html}
                  <button type="submit" class="pure-button button-xsmall" id="editsub-btnsubmit" data-prog="@{_('Editing...')}" data-success="@{_('Flair Re-Ordered')}">@{_('Move Up')}</button>
                </form>
                <form  method="POST" data-reload="true" action="@{url_for('do.flair_order_down', sub=sub.name, fl=flair.flair.data)}" class="ajaxform st-flair">
                  @{flair.csrf_token()!!html}
                  @{flair.flair!!html}
                  <button type="submit" class="pure-button button-xsmall" id="editsub-btnsubmit" data-prog="@{_('Editing...')}" data-success="@{_('Flair Re-Ordered')}">@{_('Move Down')}</button>
                </form>
                <form  method="POST" data-reload="true" action="@{url_for('do.delete_flair', sub=sub.name)}" class="ajaxform st-flair">
                  @{flair.csrf_token()!!html}
                  @{flair.flair!!html}
                  <button type="submit" class="pure-button button-xsmall" id="editsub-btnsubmit" data-prog="@{_('Deleting...')}" data-success="@{_('Deleted!')}">@{_('Delete')}</button>
                </form>
              </td>
            </tr>
          @end
          </tbody>
        </table>
      </div>
    @end
    </div>
  </div>
@end
