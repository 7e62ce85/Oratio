# Lemmy ì´ë¯¸ì§€ ì¸ë„¤ì¼ ë¬¸ì œ í•´ê²° ê³¼ì • - ê¸°ìˆ ì  í•µì‹¬ ìš”ì•½

## ë¬¸ì œ ìƒí™©
- í˜„ìƒ: ë©”ì¸í˜ì´ì§€ì—ì„œ ì´ë¯¸ì§€ ê²Œì‹œë¬¼ì˜ ì¸ë„¤ì¼ì´ ê²€ì€ìƒ‰ ë°”ë¡œê°€ê¸° ì•„ì´ì½˜ìœ¼ë¡œë§Œ í‘œì‹œ
- ì˜ˆìƒ ë™ì‘: ì´ë¯¸ì§€ ë¯¸ë¦¬ë³´ê¸° ì¸ë„¤ì¼ + 'í¼ì³ë³´ê¸°' ê¸°ëŠ¥
- URL íŒ¨í„´: https://oratio.space/pictrs/image/ì´ë¯¸ì§€ë„˜ë²„.jpeg (thumbnail íŒŒë¼ë¯¸í„° ì—†ìŒ)

## í•µì‹¬ ë¬¸ì œ ë¶„ì„

### 1. ì¡°ê±´ë¶€ ë Œë”ë§ ë¡œì§
íŒŒì¼: /srv/lemmy/lemmy-ui-custom/src/shared/components/post/post-listing.tsx
ë©”ì„œë“œ: thumbnail()

```typescript
if (!this.props.hideImage && url && isImage(url) && thumbnail) {
  // âœ… í¼ì³ë³´ê¸° ë²„íŠ¼ ìƒì„±
} else if (!this.props.hideImage && url && thumbnail && !isVideo(url)) {
  // ğŸ”— ì™¸ë¶€ ë§í¬ ìƒì„±  
} else if (url) {
  // ğŸš« ê²€ì€ìƒ‰ ì•„ì´ì½˜ (í˜„ì¬ ì—¬ê¸°ë¡œ ë¹ ì§)
}
```

### 2. ë””ë²„ê¹… ë¡œê·¸ ê²°ê³¼
```javascript
ğŸ–¼ï¸ Thumbnail Debug: {
  postId: 67, 
  url: "http://localhost/pictrs/image/0c0c617c-3328-4d12-a400-b3217925e28c.jpeg", 
  thumbnail: undefined,  // â† í•µì‹¬ ë¬¸ì œ!
  isImage: true, 
  hideImage: undefined
}
ğŸš« ê²€ì€ìƒ‰ ì•„ì´ì½˜ (ì™¸ë¶€ ë§í¬)
```

## ê·¼ë³¸ ì›ì¸
- post.thumbnail_urlì´ undefined: ì„œë²„ì—ì„œ ì¸ë„¤ì¼ URLì„ ì œê³µí•˜ì§€ ì•ŠìŒ
- ì¡°ê±´ ì‹¤íŒ¨: thumbnail ê°’ì´ ì—†ì–´ì„œ ì²« ë²ˆì§¸ ì¡°ê±´(&& thumbnail)ì´ ì‹¤íŒ¨
- fallback ë¡œì§: ì„¸ ë²ˆì§¸ ì¡°ê±´ìœ¼ë¡œ ë¹ ì ¸ì„œ ê²€ì€ìƒ‰ ì™¸ë¶€ë§í¬ ì•„ì´ì½˜ í‘œì‹œ

## í•´ê²° ë°©ë²•

### ìˆ˜ì •ëœ ì¡°ê±´ë¬¸
```typescript
// ê¸°ì¡´: ì¸ë„¤ì¼ì´ ìˆì–´ì•¼ë§Œ í¼ì³ë³´ê¸° ê°€ëŠ¥
if (!this.props.hideImage && url && isImage(url) && thumbnail) {

// ìˆ˜ì •: ì¸ë„¤ì¼ì´ ì—†ì–´ë„ ì´ë¯¸ì§€ URLì´ ìˆìœ¼ë©´ í¼ì³ë³´ê¸° ê°€ëŠ¥
if (!this.props.hideImage && url && isImage(url)) {
```

### ìˆ˜ì •ëœ thumbnail() ë©”ì„œë“œ ì „ì²´ ì½”ë“œ
```typescript
thumbnail() {
  const post = this.postView.post;
  const url = post.url;
  const thumbnail = post.thumbnail_url;

  // ì´ë¯¸ì§€ URLì´ ìˆê³  ì´ë¯¸ì§€ í˜•ì‹ì´ë¼ë©´ ì¸ë„¤ì¼ì´ ì—†ì–´ë„ í¼ì³ë³´ê¸° ë²„íŠ¼ ìƒì„±
  if (!this.props.hideImage && url && isImage(url)) {
    return (
      <button
        type="button"
        className="thumbnail rounded overflow-hidden d-inline-block position-relative p-0 border-0 bg-transparent"
        data-tippy-content={I18NextService.i18n.t("expand_here")}
        onClick={linkEvent(this, this.handleImageExpandClick)}
        aria-label={I18NextService.i18n.t("expand_here")}
      >
        {thumbnail ? this.imgThumb(thumbnail) : (
          // ì¸ë„¤ì¼ì´ ì—†ìœ¼ë©´ ì›ë³¸ ì´ë¯¸ì§€ì˜ ì¸ë„¤ì¼ ë²„ì „ì„ ìƒì„±
          <PictrsImage
            src={url}
            thumbnail
            alt={post.alt_text}
            nsfw={post.nsfw || this.postView.community.nsfw}
          />
        )}
        <Icon
          icon="image"
          classes="d-block text-white position-absolute end-0 top-0 mini-overlay text-opacity-75 text-opacity-100-hover"
        />
      </button>
    );
  } else if (!this.props.hideImage && url && thumbnail && !isVideo(url)) {
    return (
      <a
        className="thumbnail rounded overflow-hidden d-inline-block position-relative p-0 border-0"
        href={url}
        rel={relTags}
        title={url}
        target={this.linkTarget}
      >
        {this.imgThumb(thumbnail)}
        <Icon
          icon="external-link"
          classes="d-block text-white position-absolute end-0 top-0 mini-overlay text-opacity-75 text-opacity-100-hover"
        />
      </a>
    );
  } else if (url) {
    if ((!this.props.hideImage && isVideo(url)) || post.embed_video_url) {
      return (
        <a
          className={classNames(
            "thumbnail rounded",
            thumbnail
              ? "overflow-hidden d-inline-block position-relative p-0 border-0"
              : "text-body bg-light d-flex justify-content-center",
          )}
          href={url}
          title={url}
          rel={relTags}
          data-tippy-content={I18NextService.i18n.t("expand_here")}
          onClick={linkEvent(this, this.handleImageExpandClick)}
          aria-label={I18NextService.i18n.t("expand_here")}
          target={this.linkTarget}
        >
          {thumbnail && this.imgThumb(thumbnail)}
          <Icon
            icon="video"
            classes={
              thumbnail
                ? "d-block text-white position-absolute end-0 top-0 mini-overlay text-opacity-75 text-opacity-100-hover"
                : "d-flex align-items-center"
            }
          />
        </a>
      );
    } else {
      return (
        <a
          className="text-body"
          href={url}
          title={url}
          rel={relTags}
          target={this.linkTarget}
        >
          <div className="thumbnail rounded bg-light d-flex justify-content-center">
            <Icon icon="external-link" classes="d-flex align-items-center" />
          </div>
        </a>
      );
    }
  } else {
    return (
      <Link
        className="text-body"
        to={`/post/${post.id}`}
        title={I18NextService.i18n.t("comments")}
      >
        <div className="thumbnail rounded bg-light d-flex justify-content-center">
          <Icon icon="message-square" classes="d-flex align-items-center" />
        </div>
      </Link>
    );
  }
}
```

## ê´€ë ¨ ì»´í¬ë„ŒíŠ¸ êµ¬ì¡°

### ì´ë¯¸ì§€ URL ì²˜ë¦¬
- PictrsImage ì»´í¬ë„ŒíŠ¸: /shared/components/common/pictrs-image.tsx
- URL ë³€í™˜: ?format=webp&thumbnail=256 íŒŒë¼ë¯¸í„° ìë™ ì¶”ê°€
- ì´ë¯¸ì§€ ê²€ì¦: /shared/utils/media/is-image.ts

### ìƒíƒœ ê´€ë¦¬
- imageExpanded: í¼ì³ë³´ê¸° ìƒíƒœ
- handleImageExpandClick: í† ê¸€ ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬
- ì¡°ê±´ë¶€ ë Œë”ë§: {this.state.imageExpanded && !this.props.hideImage && this.img}

## ì ìš© ë°©ë²•

1. íŒŒì¼ ê²½ë¡œ: /srv/lemmy/lemmy-ui-custom/src/shared/components/post/post-listing.tsx
2. ë©”ì„œë“œ: thumbnail()
3. ìˆ˜ì • ë‚´ìš©: ì²« ë²ˆì§¸ if ì¡°ê±´ì—ì„œ '&& thumbnail' ë¶€ë¶„ ì œê±°
4. ëŒ€ì²´ ë¡œì§: thumbnailì´ ì—†ìœ¼ë©´ ì›ë³¸ ì´ë¯¸ì§€ë¥¼ PictrsImageë¡œ ì¸ë„¤ì¼ ìƒì„±

## ë¹Œë“œ ë° ë°°í¬
```bash
cd /srv/lemmy/lemmy-ui-custom
npm run build
```

## ìµœì¢… ê²°ê³¼
ì´ ìˆ˜ì •ìœ¼ë¡œ ì„œë²„ì—ì„œ ë³„ë„ì˜ ì¸ë„¤ì¼ URLì„ ì œê³µí•˜ì§€ ì•Šì•„ë„ ì´ë¯¸ì§€ ê²Œì‹œë¬¼ì—ì„œ ì •ìƒì ìœ¼ë¡œ 'í¼ì³ë³´ê¸°' ê¸°ëŠ¥ì´ ì‘ë™í•˜ê²Œ ë©ë‹ˆë‹¤.

- ì¸ë„¤ì¼ í´ë¦­ ì‹œ: ê²Œì‹œê¸€ ë°”ë¡œ ì•„ë˜ì— ì´ë¯¸ì§€ í¼ì³ì§
- í¼ì³ì§„ ì´ë¯¸ì§€ í´ë¦­ ì‹œ: ìƒˆì°½ì—ì„œ ì›ë³¸ ì´ë¯¸ì§€ ë³´ê¸°
- URL ìë™ ë³€í™˜: PictrsImage ì»´í¬ë„ŒíŠ¸ê°€ ?thumbnail=256 íŒŒë¼ë¯¸í„° ìë™ ì¶”ê°€
