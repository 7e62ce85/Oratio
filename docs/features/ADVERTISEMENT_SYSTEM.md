# ğŸ“¢ Oratio ê´‘ê³  ì‹œìŠ¤í…œ

## ê°œìš”

ì‚¬ìš©ìê°€ BCH í¬ë ˆë”§ìœ¼ë¡œ ê´‘ê³ ë¥¼ êµ¬ë§¤í•˜ê³ , ê´€ë¦¬ì ìŠ¹ì¸ í›„ ì‚¬ì´íŠ¸ì— í‘œì‹œë˜ëŠ” ì‹œìŠ¤í…œ.

**ìµœì¢… ì—…ë°ì´íŠ¸**: 2025-12-30

---

## í•µì‹¬ ê¸°ëŠ¥

### 1. í™•ë¥  ê¸°ë°˜ ê´‘ê³  ì„ íƒ
- **ê³µì‹**: `ë‚´ ì˜ˆì‚° / eligible ê´‘ê³  ì˜ˆì‚° í•©ê³„ Ã— 100%`
- ì˜ˆ: eligible ê´‘ê³  ì´ ì˜ˆì‚° $3 ì¤‘ ë‚´ê°€ $2 â†’ 67% í™•ë¥ ë¡œ ë…¸ì¶œ

### 2. ìº í˜ì¸ ìƒì„± ì‹œ ì¦‰ì‹œ í¬ë ˆë”§ ì°¨ê° (2025-12-20 ì—…ë°ì´íŠ¸)
- **Create Campaign ì‹œì **ì— ì„¤ì •í•œ Costê°€ **ì¦‰ì‹œ ì°¨ê°**
- Admin **Reject ì‹œ ì „ì•¡ í™˜ë¶ˆ** (ìë™)
- Admin Approve ì‹œ ì¶”ê°€ ì°¨ê° ì—†ìŒ (ì´ë¯¸ ì°¨ê°ë¨)

### 2. í˜ì´ì§€ ë¡œë“œë‹¹ í•œ ë²ˆ ì„ íƒ (2025-12-20~)
- í•œ ê´‘ê³ ì£¼ì˜ ìº í˜ì¸ì´ ì„ íƒë˜ë©´ **ëª¨ë“  ìœ„ì¹˜** ë™ì¼ ìº í˜ì¸ í‘œì‹œ ("one campaign per page")
- ê° ìœ„ì¹˜ë³„ë¡œ ë‹¤ë¥¸ ê´‘ê³ ê°€ ë‚˜ì˜¤ì§€ ì•ŠìŒ
- **í”„ë¡ íŠ¸ì—”ë“œ êµ¬í˜„:**
  - `ad-banner.tsx`ì—ì„œ **Promise ê¸°ë°˜ ì‹±ê¸€í†¤ + ì „ì—­ ìºì‹œ**ë¡œ ê´‘ê³  ì„ íƒì„ ë³´ì¥
  - í˜ì´ì§€ ë‚´ ì—¬ëŸ¬ ê´‘ê³  ìœ„ì¹˜(í—¤ë”/ì‚¬ì´ë“œë°”/í‘¸í„° ë“±)ì—ì„œ ë™ì‹œì— ê´‘ê³  ìš”ì²­ì´ ë°œìƒí•´ë„, ìµœì´ˆ 1íšŒë§Œ ë°±ì—”ë“œì— ìš”ì²­
  - **SPA ë„¤ë¹„ê²Œì´ì…˜(í˜ì´ì§€ ì´ë™)** ì‹œ URL ë³€í™”ë¥¼ ê°ì§€í•´ ìºì‹œë¥¼ ë¦¬ì…‹, ìƒˆ ê´‘ê³ ë¥¼ ì„ íƒ
  - ì»¤ë®¤ë‹ˆí‹° íƒ€ê²ŸíŒ…ì´ ìˆëŠ” ê²½ìš°, ì»¤ë®¤ë‹ˆí‹° ì •ë³´ê°€ ì „ì—­(global)ìœ¼ë¡œ ê³µìœ ë˜ì–´ ëª¨ë“  ìœ„ì¹˜ì—ì„œ ë™ì¼ íƒ€ê²ŸíŒ… ê´‘ê³ ê°€ ìš°ì„  ë…¸ì¶œ
  - ì»¤ë®¤ë‹ˆí‹° ì •ë³´ê°€ ì—†ëŠ”(í—¤ë”/í‘¸í„° ë“±) ìœ„ì¹˜ëŠ” 100ms ëŒ€ê¸° í›„ ì „ì—­ ì»¤ë®¤ë‹ˆí‹° ì •ë³´/ìºì‹œë¥¼ í™œìš©í•´ ì¼ê´€ì„± ìœ ì§€
  - (ì•Œë ¤ì§„ ì´ìŠˆ) ê°„í—ì ìœ¼ë¡œ í—¤ë”/í‘¸í„° ê´‘ê³ ê°€ ì‚¬ì´ë“œë°”ë³´ë‹¤ ë¨¼ì € ë Œë”ë§ë  ê²½ìš°, íƒ€ê²ŸíŒ… ê´‘ê³ ê°€ ì•„ë‹Œ ì¼ë°˜ ê´‘ê³ ê°€ ë…¸ì¶œë  ìˆ˜ ìˆìŒ(ì•½ 10% ë¯¸ë§Œ, race condition). ì´ ê²½ìš°ì—ë„ í•œ í˜ì´ì§€ ë‚´ ëª¨ë“  ìœ„ì¹˜ëŠ” ë™ì¼ ê´‘ê³ ë¥¼ ìœ ì§€í•¨.
  - **ê´‘ê³  ë°°ê²½ìƒ‰:** ëª¨ë“  ìœ„ì¹˜ì—ì„œ í°ìƒ‰(#ffffff)ìœ¼ë¡œ í†µì¼, credit ë¯¸ë¦¬ë³´ê¸°/í‘œì‹œ ì œê±°
  - **ë¡œë“œ í¬ì¸íŠ¸(load_points) ì°¨ê°:** í•œ í˜ì´ì§€ ë‚´ í•œ ë²ˆë§Œ ì°¨ê°(ì¤‘ë³µ ì°¨ê° ë°©ì§€)

### 3. 3ê°œ ê´‘ê³  ìœ„ì¹˜ (2025-12-25 ì—…ë°ì´íŠ¸)
| ìœ„ì¹˜ | ê¶Œì¥ ì‚¬ì´ì¦ˆ | ì„¤ëª… |
|------|-------------|------|
| Sidebar | 300Ã—250 or 300Ã—600 | Post, Community, Feed(ì²«í˜ì´ì§€) ì‚¬ì´ë“œë°” |
| Top | 728Ã—90 or 970Ã—90 | ê²Œì‹œê¸€ ìƒë‹¨ (header) |
| Bottom | 728Ã—90 | í‘¸í„° ë°”ë¡œ ìœ„ (website_bottom) |

**ì œê±°ëœ ìœ„ì¹˜**: Comments Inline (2025-12-20)

### 4. ì´ë¯¸ì§€ ì—…ë¡œë“œ
- Lemmy pictrs ì‹œìŠ¤í…œ í™œìš©
- ìœ„ì¹˜ë³„ ê°œë³„ ì´ë¯¸ì§€ ë“±ë¡ ê°€ëŠ¥
- ë¯¸ë“±ë¡ ìœ„ì¹˜ëŠ” ê¸°ë³¸ oratio.space ê´‘ê³  í‘œì‹œ
- **ëª¨ë°”ì¼ ë°˜ì‘í˜•**: CSSë¡œ ìë™ ìŠ¤ì¼€ì¼ (728Ã—90 ì´ë¯¸ì§€ë„ ëª¨ë°”ì¼ì—ì„œ ì •ìƒ í‘œì‹œ)

### 5. ìº í˜ì¸ ê¸°ê°„
- ê¸°ë³¸ê°’: 1ê°œì›” (30ì¼)
- ê¸°ê°„ ë‚´ í™œì„± ìº í˜ì¸ë§Œ í™•ë¥  ê³„ì‚°ì— í¬í•¨

### 6. ê´€ë¦¬ì ìŠ¹ì¸
- ëª¨ë“  ìº í˜ì¸ì€ ê´€ë¦¬ì ìŠ¹ì¸ í•„ìš”
- ìµœì†Œ ì˜ˆì‚°: $1 USD (í…ŒìŠ¤íŠ¸ ëª¨ë“œ, ìš´ì˜ ì‹œ $10 ê¶Œì¥)

### 7. ë¡œë“œ í¬ì¸íŠ¸ ì‹œìŠ¤í…œ âœ… (2025-12-30 ì—…ë°ì´íŠ¸)
- **íƒ€ê²Ÿ ë¯¸ë§¤ì¹˜ ì‹œ ë¡œë“œ í¬ì¸íŠ¸ +1**: ê´‘ê³ ê°€ íƒ€ê²Ÿ ì¡°ê±´(ì»¤ë®¤ë‹ˆí‹°, ì •ê·œì‹)ì— ë§ì§€ ì•Šì•„ í‘œì‹œë˜ì§€ ì•Šìœ¼ë©´ í¬ì¸íŠ¸ ì ë¦½
- **ì„¸ì…˜ë‹¹ 1íšŒë§Œ ì¦ê°€**: `session_id` ê¸°ë°˜ìœ¼ë¡œ ê°™ì€ í˜ì´ì§€ ë¡œë“œì—ì„œ ì¤‘ë³µ ì¦ê°€ ë°©ì§€
- **ë¡œë“œ í¬ì¸íŠ¸ ìˆëŠ” ê´‘ê³  ìš°ì„  í’€**: load_points > 0ì¸ eligible ê´‘ê³ ë“¤ì´ ìš°ì„  í’€ì—ì„œ í™•ë¥  ì„ íƒ
- **ì„ íƒë˜ë©´ ë¡œë“œ í¬ì¸íŠ¸ -1**: ê´‘ê³ ê°€ ì‹¤ì œë¡œ í‘œì‹œë˜ë©´ í¬ì¸íŠ¸ ì°¨ê°
- ì´ ì‹œìŠ¤í…œìœ¼ë¡œ íƒ€ê²ŸíŒ… ê´‘ê³ ë„ ê³µí‰í•˜ê²Œ ë…¸ì¶œ ê¸°íšŒ ë³´ì¥

---

## ê´‘ê³  ì„ íƒ ì•Œê³ ë¦¬ì¦˜ ìƒì„¸ (2025-12-30)

í˜ì´ì§€ ë¡œë“œ ì‹œ ë°±ì—”ë“œ `select_ad_to_display()` í•¨ìˆ˜ê°€ í˜¸ì¶œë˜ì–´ ê´‘ê³ ë¥¼ ì„ íƒí•©ë‹ˆë‹¤.

### ë‹¨ê³„ë³„ ë¡œì§

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 1ë‹¨ê³„: Eligible ê´‘ê³  ìˆ˜ì§‘                                    â”‚
â”‚ - ëª¨ë“  í™œì„± ìº í˜ì¸ì— ëŒ€í•´ íƒ€ê²ŸíŒ… ë§¤ì¹˜ ì—¬ë¶€ í™•ì¸              â”‚
â”‚ - ë§¤ì¹˜ë˜ë©´ eligible_adsì— ì¶”ê°€                              â”‚
â”‚ - ë¯¸ë§¤ì¹˜ + íƒ€ê²ŸíŒ… ì„¤ì • ìˆëŠ” ê´‘ê³  â†’ load_points +1           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 2ë‹¨ê³„: í’€ ë¶„ë¦¬                                               â”‚
â”‚ - load_point_ads: load_points > 0ì¸ eligible ê´‘ê³            â”‚
â”‚ - normal_ads: load_points = 0ì¸ eligible ê´‘ê³                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 3ë‹¨ê³„: ìš°ì„  í’€ í™•ë¥  ì„ íƒ                                     â”‚
â”‚ - load_point_adsê°€ ìˆìœ¼ë©´ ì˜ˆì‚° ë¹„ìœ¨ë¡œ í™•ë¥  ì„ íƒ             â”‚
â”‚ - ì„ íƒëœ ê´‘ê³  load_points -1                                â”‚
â”‚ - ì˜ˆ: korean3($1) vs korean($2) â†’ 33% vs 67%               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 4ë‹¨ê³„: ì¼ë°˜ í’€ í™•ë¥  ì„ íƒ                                     â”‚
â”‚ - ìš°ì„  í’€ì—ì„œ ì„ íƒ ì•ˆ ëìœ¼ë©´ normal_adsì—ì„œ í™•ë¥  ì„ íƒ       â”‚
â”‚ - ì˜ˆ: nogod2($1) vs heli($2) â†’ 33% vs 67%                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### íƒ€ê²ŸíŒ… ë§¤ì¹­ ì¡°ê±´

1. **NSFW ì²´í¬**: NSFW ê´‘ê³ ëŠ” NSFW í˜ì´ì§€ì—ì„œë§Œ í‘œì‹œ
2. **ì»¤ë®¤ë‹ˆí‹° íƒ€ê²ŸíŒ…**: `show_on_all=false`ì¸ ê²½ìš° `target_communities`ì— í˜„ì¬ ì»¤ë®¤ë‹ˆí‹°ê°€ í¬í•¨ë˜ì–´ì•¼ í•¨
3. **ì •ê·œì‹ íƒ€ê²ŸíŒ…**: `target_regex`ê°€ ì„¤ì •ëœ ê²½ìš° **ê²Œì‹œê¸€ ì½˜í…ì¸ (ì œëª©+ë³¸ë¬¸+URL)**ì—ì„œ ì •ê·œì‹ ë§¤ì¹­

### ì •ê·œì‹ ë§¤ì¹­ ë™ì‘ (2025-12-30 ìˆ˜ì •)
- URLì—ì„œ `/post/{id}` íŒ¨í„´ ê°ì§€ ì‹œ Lemmy APIë¡œ ê²Œì‹œê¸€ ì½˜í…ì¸  ì¡°íšŒ
- ì¡°íšŒëœ ì½˜í…ì¸ (ì œëª© + ë³¸ë¬¸ + URL)ì—ì„œ ì •ê·œì‹ ë§¤ì¹­
- ìºì‹±ìœ¼ë¡œ ì„±ëŠ¥ ìµœì í™” (TTL 1ì‹œê°„, ìµœëŒ€ 1000ê°œ)

---

## ë³€ê²½ ì´ë ¥

### 2025-12-30
- **ì •ê·œì‹ íƒ€ê²ŸíŒ… ìˆ˜ì •**: 
  - ë¬¸ì œ: í”„ë¡ íŠ¸ì—”ë“œê°€ `page_url`ë§Œ ì „ë‹¬í•˜ì—¬ URLì—ì„œ ì •ê·œì‹ ë§¤ì¹­ ì‹œë„ â†’ ê²Œì‹œê¸€ ë‚´ìš©ì˜ í‚¤ì›Œë“œ ë§¤ì¹­ ì‹¤íŒ¨
  - ìˆ˜ì •: `_get_post_content_by_id()` í•¨ìˆ˜ ì¶”ê°€, URLì˜ post IDë¡œ Lemmy APIì—ì„œ ê²Œì‹œê¸€ ì½˜í…ì¸ (ì œëª©+ë³¸ë¬¸+URL) ì¡°íšŒ í›„ ì •ê·œì‹ ë§¤ì¹­
  - ìºì‹± ì ìš© (TTL 1ì‹œê°„, ìµœëŒ€ 1000ê°œ)
- **í™•ë¥  ê¸°ë°˜ ê´‘ê³  ì„ íƒ ë¡œì§ ìˆ˜ì •**:
  - ë¬¸ì œ: load_point ê´‘ê³  ì¤‘ ì²« ë²ˆì§¸ ë§¤ì¹˜ë§Œ ì„ íƒ (í™•ë¥  ë¬´ì‹œ)
  - ìˆ˜ì •: load_point í’€ ë‚´ì—ì„œë„ ì˜ˆì‚° ë¹„ìœ¨ì— ë”°ë¥¸ í™•ë¥  ì„ íƒ ì ìš©
  - ë¡œê·¸ í™•ì¸: heli($2) ~67%, nogod2($1) ~33% ë¹„ìœ¨ë¡œ ì„ íƒë¨
- **ê´‘ê³  ê¹œë¹¡ì„(flicker) ìˆ˜ì •**:
  - ë¬¸ì œ: í¬ë ˆë”§ ì²´í¬ ì™„ë£Œ í›„ ê´‘ê³  ë¡œë”© ì „ì— ê¸°ë³¸ ê´‘ê³ ê°€ ì ê¹ í‘œì‹œë¨
  - ìˆ˜ì •: `checkUserCredit()` ì™„ë£Œ ì‹œ `isLoadingAd=true` ì„¤ì •í•˜ì—¬ "Loading..." ìƒíƒœ ìœ ì§€
- **íŒŒì¼ ìˆ˜ì •**:
  - `ad_service.py`: `_get_post_content_by_id()`, `_check_targeting()` ì •ê·œì‹ ë¡œì§, `select_ad_to_display()` í™•ë¥  ì„ íƒ ë¡œì§
  - `ad-banner.tsx`: `isLoadingAd` ìƒíƒœ ê´€ë¦¬ ê°œì„ 

### 2025-12-25
- **ë©¤ë²„ì‹­ ì‚¬ìš©ì Impression ì¹´ìš´íŠ¸ ë²„ê·¸ ìˆ˜ì •**:
  - ë¬¸ì œ: ë©¤ë²„ì‹­ ì‚¬ìš©ìê°€ í˜ì´ì§€ ì ‘ì† ì‹œ ê´‘ê³  UIëŠ” ìˆ¨ê²¨ì§€ì§€ë§Œ impressionì´ +1 ì¹´ìš´íŠ¸ë˜ëŠ” ë²„ê·¸
  - ì›ì¸: `checkUserCredit()`ê°€ ë™ê¸° í•¨ìˆ˜(`checkUserHasGoldBadgeSync`)ë¥¼ ì‚¬ìš©í•˜ì—¬ ìºì‹œ ë¯¸ìŠ¤ ì‹œ `false` ë°˜í™˜ í›„ ê´‘ê³  fetch ë°œìƒ
  - ìˆ˜ì •:
    - `checkUserCredit()`ì—ì„œ ë¹„ë™ê¸° í•¨ìˆ˜(`checkUserHasGoldBadge`) ì‚¬ìš©ìœ¼ë¡œ ë³€ê²½
    - `componentDidUpdate`ì—ì„œ `isCheckingCredit` ì²´í¬ ì¶”ê°€ (membership í™•ì¸ ì™„ë£Œ ì „ ê´‘ê³  fetch ë°©ì§€)
    - SSR í™˜ê²½ ì²´í¬ ì¶”ê°€ (`typeof window === 'undefined'` ì‹œ ê´‘ê³  fetch ìŠ¤í‚µ)
  - íŒŒì¼: `ad-banner.tsx`

### 2025-12-20
- **ê´‘ê³  ìœ„ì¹˜ ë³€ê²½**:
  - ì¶”ê°€: Sidebar(feed ì²«í˜ì´ì§€), Website Bottom (í‘¸í„° ë°”ë¡œ ìœ„)
  - ì œê±°: Post Bottom, Comments Inline â†’ **ì¬ì¶”ê°€: Bottom (Post Bottom)**
  - í˜„ì¬ í™œì„± ìœ„ì¹˜: Sidebar, Top (Post Top + Website Bottom ê³µìœ ), Bottom
- **ê´‘ê³  í”Œë˜ì‹œ ìˆ˜ì •**: ì´ˆê¸° ë¡œë“œ ì‹œ ë³´ë¼ìƒ‰ ê¸°ë³¸ ê´‘ê³  1ì´ˆ ê¹œë¹¡ì„ â†’ `isCheckingCredit=true` ì´ˆê¸°í™”ë¡œ Loading í‘œì‹œ
- **ëª¨ë°”ì¼ ë°˜ì‘í˜• ê°œì„ **: CSS ì¶”ê°€ë¡œ 728Ã—90 ì´ë¯¸ì§€ê°€ ëª¨ë°”ì¼ì—ì„œ ì˜ë¦¬ì§€ ì•Šê³  ì¶•ì†Œ
- **Admin í™œì„± ìº í˜ì¸ ëª©ë¡ ì¶”ê°€**: ê´€ë¦¬ìê°€ ì§„í–‰ ì¤‘ì¸ ëª¨ë“  ê´‘ê³  í™•ì¸ ê°€ëŠ¥ (Visit Link ë²„íŠ¼)
- **ì´ë¯¸ì§€ ë¯¸ë¦¬ë³´ê¸° ì¶”ê°€**: My Campaigns, Pending Approvals, Admin Active Campaignsì—ì„œ ì´ë¯¸ì§€ ë¯¸ë¦¬ë³´ê¸°
- **UI ìš©ì–´ ë³€ê²½**: Monthly Budget â†’ Campaign Cost, Budget â†’ Cost
- **í¬ë ˆë”§ ì¦‰ì‹œ ì°¨ê°**: Create Campaign ì‹œ Cost ì¦‰ì‹œ ì°¨ê°, Reject ì‹œ ìë™ í™˜ë¶ˆ
- **ë¡œë“œ í¬ì¸íŠ¸ ì‹œìŠ¤í…œ ì™„ì„±**:
  - íƒ€ê²Ÿ ë¯¸ë§¤ì¹˜ ì‹œ +1 (íƒ€ê²ŸíŒ… ì„¤ì • ìˆëŠ” ê´‘ê³ ë§Œ)
  - `session_id` ê¸°ë°˜ ì¤‘ë³µ ì¦ê°€ ë°©ì§€ (ì„¸ì…˜ë‹¹ 1íšŒ)
  - ë¡œë“œ í¬ì¸íŠ¸ ìˆëŠ” ê´‘ê³  ìš°ì„  ì„ íƒ, ì„ íƒ ì‹œ -1

### 2025-12-17
- **ê´‘ê³  ìˆ¨ê¹€ ë¡œì§ ìˆ˜ì •**: BCH ì”ì•¡ ê¸°ì¤€(0.0003) â†’ ë©¤ë²„ì‹­ ì‚¬ìš©ìë§Œ ê´‘ê³  ìˆ¨ê¹€
  - `ad-banner.tsx`ì—ì„œ `checkUserHasGoldBadgeSync()` ì‚¬ìš©ìœ¼ë¡œ ë³€ê²½
  - ë©¤ë²„ì‹­ ì—†ëŠ” ì‚¬ìš©ì(admin ë“±)ëŠ” ê´‘ê³  ì •ìƒ í‘œì‹œ
- **ìº í˜ì¸ ìƒì„± ì—ëŸ¬ í•¸ë“¤ë§ ê°œì„ **: ì„œë²„ ì—ëŸ¬ ë©”ì‹œì§€ë¥¼ í† ìŠ¤íŠ¸ë¡œ ìƒì„¸ í‘œì‹œ
- **ìµœì†Œ ì˜ˆì‚° $1ë¡œ ì„ì‹œ ë³€ê²½** (í…ŒìŠ¤íŠ¸ìš©):
  - í”„ë¡ íŠ¸ì—”ë“œ: `ads.tsx` min ì†ì„± ë³€ê²½
  - ë°±ì—”ë“œ: `ad_service.py` ê¸°ë³¸ê°’ ë³€ê²½
  - DB: `ad_config.minimum_budget_usd` ì—…ë°ì´íŠ¸

---

## ê¸°ìˆ  êµ¬í˜„

### ë°ì´í„°ë² ì´ìŠ¤ í…Œì´ë¸” (SQLite: /data/payments.db)

#### ad_credits (ê´‘ê³ ì£¼ í¬ë ˆë”§)
| ì»¬ëŸ¼ | íƒ€ì… | ì„¤ëª… |
|------|------|------|
| username | TEXT PK | ê´‘ê³ ì£¼ ì‚¬ìš©ìëª… |
| credit_balance_usd | REAL | í˜„ì¬ ì”ì•¡ (USD) |
| total_deposited_usd | REAL | ì´ ì…ê¸ˆì•¡ |
| total_spent_usd | REAL | ì´ ì‚¬ìš©ì•¡ |
| created_at, updated_at | INTEGER | íƒ€ì„ìŠ¤íƒ¬í”„ |

#### ad_campaigns (ê´‘ê³  ìº í˜ì¸)
| ì»¬ëŸ¼ | íƒ€ì… | ì„¤ëª… |
|------|------|------|
| id | TEXT PK | UUID |
| advertiser_username | TEXT | ê´‘ê³ ì£¼ |
| title, link_url, alt_text | TEXT | ê´‘ê³  ì½˜í…ì¸  |
| image_sidebar_url | TEXT | ì‚¬ì´ë“œë°” ì´ë¯¸ì§€ (300Ã—250) |
| image_post_top_url | TEXT | ìƒë‹¨ ì´ë¯¸ì§€ (728Ã—90) |
| image_post_bottom_url | TEXT | í•˜ë‹¨ ì´ë¯¸ì§€ (728Ã—90) |
| image_feed_inline_url | TEXT | í”¼ë“œ ì¸ë¼ì¸ ì´ë¯¸ì§€ |
| monthly_budget_usd | REAL | ì›” ì˜ˆì‚° (í™•ë¥  ê³„ì‚°ìš©) |
| approval_status | TEXT | pending / approved / rejected |
| target_communities | TEXT | JSON ë°°ì—´ (null = ì „ì²´) |
| target_regex | TEXT | ì •ê·œì‹ íŒ¨í„´ |
| show_on_all | BOOLEAN | ì „ì²´ ë…¸ì¶œ ì—¬ë¶€ |
| load_points | INTEGER | ë¡œë“œ í¬ì¸íŠ¸ (ë¯¸ë…¸ì¶œ ì‹œ +1) |
| is_nsfw | BOOLEAN | NSFW ê´‘ê³  ì—¬ë¶€ |
| start_date, end_date | INTEGER | ìº í˜ì¸ ê¸°ê°„ |
| is_active, is_deleted | BOOLEAN | ìƒíƒœ í”Œë˜ê·¸ |
| total_impressions, total_clicks | INTEGER | í†µê³„ |

#### ad_impressions (ë…¸ì¶œ ê¸°ë¡)
| ì»¬ëŸ¼ | íƒ€ì… | ì„¤ëª… |
|------|------|------|
| id | TEXT PK | UUID |
| campaign_id | TEXT FK | ìº í˜ì¸ ID |
| advertiser_username | TEXT | ê´‘ê³ ì£¼ |
| page_url, community_name | TEXT | ë…¸ì¶œ ì»¨í…ìŠ¤íŠ¸ |
| ad_slot | TEXT | ê´‘ê³  ìœ„ì¹˜ (sidebar, top, bottom) |
| clicked | BOOLEAN | í´ë¦­ ì—¬ë¶€ |
| created_at | INTEGER | ë…¸ì¶œ ì‹œê°„ |

#### ad_transactions (ê±°ë˜ ë‚´ì—­)
| ì»¬ëŸ¼ | íƒ€ì… | ì„¤ëª… |
|------|------|------|
| id | TEXT PK | UUID |
| advertiser_username | TEXT | ê´‘ê³ ì£¼ |
| transaction_type | TEXT | deposit / spend / refund / campaign_cost |
| amount_usd | REAL | ê¸ˆì•¡ |
| description | TEXT | ì„¤ëª… |
| created_at | INTEGER | ê±°ë˜ ì‹œê°„ |

#### ad_config (ì‹œìŠ¤í…œ ì„¤ì •)
| ì»¬ëŸ¼ | íƒ€ì… | ê¸°ë³¸ê°’ | ì„¤ëª… |
|------|------|--------|------|
| minimum_budget_usd | REAL | 1.0 | ìµœì†Œ ìº í˜ì¸ ì˜ˆì‚° |
| cost_per_impression_usd | REAL | 0.001 | ë…¸ì¶œë‹¹ ë¹„ìš© |
| cost_per_click_usd | REAL | 0.01 | í´ë¦­ë‹¹ ë¹„ìš© |
| max_regex_length | INTEGER | 500 | ì •ê·œì‹ ìµœëŒ€ ê¸¸ì´ |

### ì£¼ìš” ì¡°íšŒ ì¿¼ë¦¬

```sql
-- í™œì„± ìº í˜ì¸ ì¡°íšŒ (ê´‘ê³  ì„ íƒìš©)
SELECT * FROM ad_campaigns 
WHERE approval_status = 'approved' 
  AND is_active = TRUE 
  AND is_deleted = FALSE
  AND (start_date IS NULL OR start_date <= strftime('%s','now'))
  AND (end_date IS NULL OR end_date >= strftime('%s','now'))
ORDER BY load_points DESC, monthly_budget_usd DESC;

-- ìº í˜ì¸ ìƒíƒœ í™•ì¸ (ê´€ë¦¬ìš©)
SELECT title, monthly_budget_usd, load_points, target_communities, target_regex, show_on_all
FROM ad_campaigns 
WHERE approval_status = 'approved' AND is_active = 1
ORDER BY load_points DESC;

-- ê´‘ê³ ì£¼ í¬ë ˆë”§ ì”ì•¡ ì¡°íšŒ
SELECT credit_balance_usd FROM ad_credits WHERE username = ?;

-- ë…¸ì¶œ í†µê³„ (ìµœê·¼ Nì¼)
SELECT campaign_id, COUNT(*) as impressions, SUM(CASE WHEN clicked THEN 1 ELSE 0 END) as clicks
FROM ad_impressions 
WHERE created_at > strftime('%s','now') - (86400 * ?)
GROUP BY campaign_id;

-- ìŠ¬ë¡¯ë³„ ë…¸ì¶œ í†µê³„
SELECT ad_slot, COUNT(*) as count FROM ad_impressions 
WHERE created_at > strftime('%s','now') - (86400 * 90)
GROUP BY ad_slot;
```

### API ì—”ë“œí¬ì¸íŠ¸

| Endpoint | Method | ì„¤ëª… |
|----------|--------|------|
| `/api/ads/display` | GET | ê´‘ê³  ì„ íƒ (4ê°œ ìœ„ì¹˜ ì´ë¯¸ì§€ ë°˜í™˜) |
| `/api/ads/click` | POST | í´ë¦­ ê¸°ë¡ |
| `/api/ads/credits/{username}` | GET | í¬ë ˆë”§ ì¡°íšŒ |
| `/api/ads/campaigns` | POST | ìº í˜ì¸ ìƒì„± |
| `/api/ads/total-budget` | GET | ì´ í™œì„± ì˜ˆì‚° ì¡°íšŒ |
| `/api/ads/admin/pending` | GET | ìŠ¹ì¸ ëŒ€ê¸° ëª©ë¡ |
| `/api/ads/admin/approve/{id}` | POST | ìº í˜ì¸ ìŠ¹ì¸ |

---

## íŒŒì¼ ìœ„ì¹˜

### Backend
- `/oratio/bitcoincash_service/services/ad_service.py` - í•µì‹¬ ë¡œì§
- `/oratio/bitcoincash_service/routes/ads.py` - API ë¼ìš°íŠ¸

### Frontend
- `/lemmy-ui-custom/src/shared/components/person/ads.tsx` - ìº í˜ì¸ ê´€ë¦¬ í˜ì´ì§€
- `/lemmy-ui-custom/src/shared/components/common/ad-banner.tsx` - ê´‘ê³  í‘œì‹œ ì»´í¬ë„ŒíŠ¸ (Promise ì‹±ê¸€í†¤, ì „ì—­ ìºì‹œ, SPA ë„¤ë¹„ê²Œì´ì…˜ ëŒ€ì‘, íƒ€ê²ŸíŒ… race condition ì™„í™”)

### Database
- `/oratio/migrations/advertisement_system.sql` - ì´ˆê¸° ìŠ¤í‚¤ë§ˆ
- `/oratio/migrations/advertisement_multi_position.sql` - 4ìœ„ì¹˜ ì´ë¯¸ì§€ ì¶”ê°€

---

## ì´ˆê¸° í¬ë ˆë”§

| ì‚¬ìš©ì | í¬ë ˆë”§ |
|--------|--------|
| gookjob | $10 USD |

---

## ì‘ì—… ë¡œê·¸

### 2025-12-16

#### ì™„ë£Œëœ ì‘ì—…

**1. BCH í¬ë ˆë”§ â†’ ê´‘ê³  í¬ë ˆë”§ ê²°ì œ ì—°ë™**
- `/api/ads/credits/purchase` ì—”ë“œí¬ì¸íŠ¸ ì¶”ê°€
- `/api/ads/credits/balance/<username>` ì—”ë“œí¬ì¸íŠ¸ ì¶”ê°€
- ì‹¤ì‹œê°„ BCH ê°€ê²© Coinbase API ì—°ë™ (USD í™˜ì‚°)
- ê´‘ê³  í¬ë ˆë”§ ì¶©ì „ ëª¨ë‹¬ì— BCH ì”ì•¡ ë° USD í™˜ì‚° í‘œì‹œ

**2. API ë²„ê·¸ ìˆ˜ì •**
- `user_credits` í…Œì´ë¸” ì»¬ëŸ¼ëª… ìˆ˜ì •: `credit_bch` â†’ `credit_balance`, `username` â†’ `user_id`
- `get_ad_credits()` ë°˜í™˜ê°’ float ì²˜ë¦¬ ìˆ˜ì • (dictê°€ ì•„ë‹Œ float)
- BCH Balance API 500 ì—ëŸ¬ ìˆ˜ì •

**3. Post Bottom ê´‘ê³  ì„¹ì…˜ í™œì„±í™”**
- `post.tsx`ì— `<AdBanner position="footer" section="post_bottom" />` ì¶”ê°€
- ìº í˜ì¸ ìƒì„± UIì— Post Bottom ì´ë¯¸ì§€ ì—…ë¡œë“œ í•„ë“œ ì¶”ê°€

**4. UI ê°œì„ **
- ë¹ ë¥¸ í…ŒìŠ¤íŠ¸ìš© $0.1 ë²„íŠ¼ ì¶”ê°€ (ê¸°ì¡´: 10, 25, 50, 100)
- "Feed Inline" â†’ "Comments Inline (shown between comments)" ëª…ì¹­ ë³€ê²½
- Navbar `console.log('[Navbar Render]...')` ë””ë²„ê·¸ ë¡œê·¸ ì œê±°

#### ì•Œë ¤ì§„ ì´ìŠˆ (ë¯¸í•´ê²°)
- [ ] í”„ë¡ íŠ¸ì—”ë“œì—ì„œ ìº í˜ì¸ ìƒì„± ì‹œ ë¬¸ì œ ê°€ëŠ¥ì„± (APIëŠ” ì •ìƒ ì‘ë™ í™•ì¸)
- [ ] Comments Inline ê´‘ê³  í¬ê¸° í™•ì¸ í•„ìš” (í˜„ì¬ 300Ã—250px)
- [ ] "one campaign per page" ë¡œì§ì—ë„ ë¶ˆêµ¬í•˜ê³ , ê°„í—ì ìœ¼ë¡œ(ì•½ 10% ë¯¸ë§Œ) ì»¤ë®¤ë‹ˆí‹° íƒ€ê²ŸíŒ… ê´‘ê³ ê°€ ì•„ë‹Œ ì¼ë°˜ ê´‘ê³ ê°€ ë…¸ì¶œë˜ëŠ” í˜„ìƒ(race condition, ì£¼ë¡œ í—¤ë”/í‘¸í„°ê°€ ë¨¼ì € ë Œë”ë§ë  ë•Œ). ëª¨ë“  ìœ„ì¹˜ëŠ” ë™ì¼ ê´‘ê³ ë¥¼ ìœ ì§€í•¨. (SPA í™˜ê²½ íŠ¹ì„±ìƒ ì™„ì „í•œ í•´ê²°ì€ ì–´ë ¤ì›€)

---

## TODO (í–¥í›„)

- [x] ~~í¬ë ˆë”§ BCH ê²°ì œ ì—°ë™~~ (2025-12-16 ì™„ë£Œ)
- [x] ~~ê´‘ê³  ìˆ¨ê¹€ ë©¤ë²„ì‹­ ì „ìš©ìœ¼ë¡œ ìˆ˜ì •~~ (2025-12-17 ì™„ë£Œ)
- [x] ~~ìº í˜ì¸ ìƒì„± ì—ëŸ¬ ìƒì„¸ í‘œì‹œ~~ (2025-12-17 ì™„ë£Œ)
- [x] ~~ë¡œë“œ í¬ì¸íŠ¸ ì‹œìŠ¤í…œ í™œì„±í™”~~ (2025-12-20 ì™„ë£Œ)
- [x] ~~í”„ë¡ íŠ¸ì—”ë“œ Promise ì‹±ê¸€í†¤/ì „ì—­ ìºì‹œ/SPA ë„¤ë¹„ê²Œì´ì…˜ ëŒ€ì‘~~ (2025-12-20 ì™„ë£Œ)
- [x] ~~ì •ê·œì‹ íƒ€ê²ŸíŒ… ìˆ˜ì • (ê²Œì‹œê¸€ ì½˜í…ì¸ ì—ì„œ ë§¤ì¹­)~~ (2025-12-30 ì™„ë£Œ)
- [x] ~~load_point í’€ í™•ë¥  ì„ íƒ ë¡œì§ ìˆ˜ì •~~ (2025-12-30 ì™„ë£Œ)
- [x] ~~ê´‘ê³  ê¹œë¹¡ì„(flicker) ìˆ˜ì •~~ (2025-12-30 ì™„ë£Œ)
- [ ] ì»¤ë®¤ë‹ˆí‹°ë³„ íƒ€ê²ŸíŒ… ìƒì„¸ í…ŒìŠ¤íŠ¸
- [ ] ê´‘ê³  í†µê³„ ëŒ€ì‹œë³´ë“œ
